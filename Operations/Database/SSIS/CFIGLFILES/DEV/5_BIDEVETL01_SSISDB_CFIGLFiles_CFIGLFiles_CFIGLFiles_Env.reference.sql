/*
Script Name: C:\Users\jgabe\Desktop\BIDEVETL01\CFIGLFiles\
Generated From Catalog Instance: BIDEVETL01
Catalog Name: SSISDB
Folder Name: CFIGLFiles
Project Name: CFIGLFiles
Reference Name: CFIGLFiles/CFIGLFiles_Env
Environment Name: CFIGLFiles_Env
Generated By: TRG\jgabe
Generated Date: 2/8/2018 8:05:22 AM
Generated From: CatalogBase v2.0.2.0 executing on: JGABEL-LAP1
*/


 -- SSISDB\CFIGLFiles\CFIGLFiles\[.|CFIGLFiles/CFIGLFiles_Env]
print 'Script Name: C:\Users\jgabe\Desktop\BIDEVETL01\CFIGLFiles\
Generated From Catalog Instance: BIDEVETL01
Catalog Name: SSISDB
Folder Name: CFIGLFiles
Project Name: CFIGLFiles
Reference Name: CFIGLFiles/CFIGLFiles_Env
Environment Name: CFIGLFiles_Env
Generated By: TRG\jgabe
Generated Date: 2/8/2018 8:05:22 AM
Generated From: CatalogBase v2.0.2.0 executing on: JGABEL-LAP1'
print ''
print '------------------------------------------------------------'
print 'Deployed to Instance: ' + @@servername
print 'Deploy Date: ' + Convert(varchar,GetDate(), 101) + ' ' + Convert(varchar,GetDate(), 108)
print 'Deployed By: ' + original_login()
print '------------------------------------------------------------'
print ''
declare @ErrMsg varchar(100) 
print 'Check for folder: CFIGLFiles ' 
If Not Exists(Select name 
              From SSISDB.[catalog].folders 
              Where name = N'CFIGLFiles') 
 begin 
  set @ErrMsg = ' - CFIGLFiles does not exist.' 
  raisError(@ErrMsg, 16, 1) 
  return 
 end 
Else 
 begin 
  print ' - CFIGLFiles folder exists.' 
 end 
print '' 
 
print 'Check for project: CFIGLFiles ' 
If Not Exists(Select name 
              From SSISDB.[catalog].projects 
              Where name = N'CFIGLFiles') 
 begin 
  set @ErrMsg = ' - CFIGLFiles project does not exist.' 
  raisError(@ErrMsg, 16, 1) 
  return 
 end 
Else 
 begin 
  print ' - CFIGLFiles project exists.' 
 end 
print '' 
 
 
print 'Check for environment: CFIGLFiles_Env ' 
If Not Exists(Select name 
              From SSISDB.[catalog].environments 
              Where name = N'CFIGLFiles_Env') 
 begin 
  set @ErrMsg = ' - CFIGLFiles_Env environment does not exist.' 
  raisError(@ErrMsg, 16, 1) 
  return 
 end 
Else 
 begin 
  print ' - CFIGLFiles_Env environment exists.' 
 end 
print '' 
 
print 'Reference SSISDB\CFIGLFiles\CFIGLFiles\[.|CFIGLFiles/CFIGLFiles_Env]'
If Not Exists(Select * 
              From SSISDB.[catalog].environment_references er 
              Join SSISDB.[catalog].projects cp 
                On cp.project_id = er.project_id 
              Join SSISDB.[catalog].folders cf 
                On cf.folder_id = cp.folder_id 
              Where cf.name = N'CFIGLFiles'
                And cp.name = N'CFIGLFiles'
                And er.environment_name = N'CFIGLFiles_Env'
                And er.environment_folder_name Is NULL)
 begin
  print ' - Creating Reference SSISDB\CFIGLFiles\CFIGLFiles\[.|CFIGLFiles/CFIGLFiles_Env]'
  Declare @reference_id bigint 
  Exec [SSISDB].[catalog].[create_environment_reference] 
       @environment_name = N'CFIGLFiles_Env' 
     , @reference_id = @reference_id OUTPUT 
     , @project_name = N'CFIGLFiles' 
     , @folder_name = N'CFIGLFiles' 
     , @environment_folder_name = NULL
     , @reference_type = R 
  print ' - Reference SSISDB\CFIGLFiles\CFIGLFiles\[.|CFIGLFiles/CFIGLFiles_Env] created'
 end
else print ' - Reference SSISDB\CFIGLFiles\CFIGLFiles\[.|CFIGLFiles/CFIGLFiles_Env] already exists.'


print ''